/**
* jQuery Scroll Element
* Copyright (c) 2011 Kevin Doyle
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
**/

(function(g){var e={prev:".scrollprev",next:".scrollnext",container:".scrollcontainer",mode:"page",pagesize:3,displayed:null,disabledclass:"disabled"},d,h,i,j,f={init:function(b){b&&g.extend(e,b);return this.each(function(){var a;d=g(this);i=d.find(e.container);j=i.find("td");if(e.displayed===null)e.displayed=e.pagesize;d.data("scroll",{prevbutton:d.find(e.prev),nextbutton:d.find(e.next),container:i,currentelement:0,elementlist:j,elementcontainer:i.find("tr"),limit:j.length-1,elementpositions:[], pages:0,pageindex:0,pagesize:e.pagesize,displayed:e.displayed,disabledclass:e.disabledclass});a=d.data("scroll");a.container.scrollLeft(0);a.container.css({overflow:"hidden"});a.prevbutton.addClass(a.disabledclass);f._calcPosition(!1,d);switch(e.mode){case "page":f._calcPages(d);a.pages<=1&&a.nextbutton.addClass(a.disabledclass);a.prevbutton.bind("click",{dir:"prev",scope:d},f._pageScroll);a.nextbutton.bind("click",{dir:"next",scope:d},f._pageScroll);break;case "infinite":a.prevbutton.removeClass(a.disabledclass), a.prevbutton.bind("click",{dir:"prev",scope:d},f._infiniteScroll),a.nextbutton.bind("click",{dir:"next",scope:d},f._infiniteScroll)}})},_pageScroll:function(b){var a=b.data.scope.data("scroll");b.data.dir==="prev"&&a.pageindex>0?(a.pageindex-=1,a.nextbutton.hasClass(a.disabledclass)&&a.nextbutton.removeClass(a.disabledclass),a.pageindex===0&&a.prevbutton.addClass(a.disabledclass)):b.data.dir==="next"&&a.pageindex<a.pages&&(a.pageindex+=1,a.prevbutton.removeClass(a.disabledclass),a.pageindex===a.pages&& a.nextbutton.addClass(a.disabledclass));h=a.elementpositions[a.pageindex*a.pagesize];a.container.stop().animate({scrollLeft:h},"fast");return!1},_infiniteScroll:function(b){var a=b.data.scope,c=a.data("scroll");h=c.elementpositions[1];b.data.dir==="prev"?(c.elementlist.eq(-1).prependTo(c.elementcontainer),c.container.scrollLeft(h),c.container.stop().animate({scrollLeft:0},"fast",function(){f._calcPosition(!0,a)})):b.data.dir==="next"&&c.container.stop().animate({scrollLeft:h},"fast",function(){c.elementlist.eq(0).appendTo(c.elementcontainer); c.container.scrollLeft(0);f._calcPosition(!0,a)});return!1},_calcPages:function(b){b=b.data("scroll");b.pages=Math.max(1,Math.ceil((b.limit-(b.displayed-b.pagesize))/b.pagesize));b.pageindex=Math.max(0,b.pageindex);b.pageindex=Math.min(b.pages,b.pageindex)},_calcPosition:function(b,a){var c=a.data("scroll");if(b)c.elementlist=c.container.find("td");c.elementlist.each(function(a){c.elementpositions[a]=Math.ceil(g(this).position().left)})}};g.fn.scrollElement=function(b){if(f[b])return f[b].apply(this, Array.prototype.slice.call(arguments,1));else if(typeof b==="object"||!b)return f.init.apply(this,arguments);else g.error("Method "+b+" does not exist on scrollElement")}})(jQuery);